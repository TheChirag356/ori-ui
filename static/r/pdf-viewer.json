{
	"$schema": "https://shadcn-svelte.com/schema/registry-item.json",
	"name": "pdf-viewer",
	"title": "Pdf Viewer",
	"type": "registry:block",
	"author": "Chirag Arora <arorachirag12005@gmail.com>",
	"description": "",
	"dependencies": [
		"@tabler/icons-svelte",
		"pdfjs-dist"
	],
	"meta": {
		"author": "TheChirag356",
		"version": "1.0.0",
		"documentation": "https://www.oriui.app/components/pdf-viewer",
		"repository": "https://github.com/TheChirag356/ori-ui"
	},
	"files": [
		{
			"content": "import Root from './pdf-viewer-root.svelte';\r\nimport Toolbar from './pdf-toolbar.svelte';\r\nimport Renderer from './pdf-renderer.svelte';\r\n\r\nexport { \r\n  type PdfViewerContext, \r\n  type PdfViewerRootProps,\r\n  type ViewMode \r\n} from './pdf-viewer-root.svelte';\r\nexport { type PdfRendererProps } from './pdf-renderer.svelte';\r\nexport { type PdfToolbarProps } from './pdf-toolbar.svelte';\r\n\r\nexport const PdfViewer = {\r\n  Root,\r\n  Toolbar,\r\n  Renderer\r\n};\r\n\r\nexport { Root, Toolbar, Renderer };\r\n",
			"type": "registry:file",
			"target": "ori/pdf-viewer/index.ts"
		},
		{
			"content": "{\n  \"createdAt\": \"2026-01-02T14:52:31.536Z\"\n}",
			"type": "registry:file",
			"target": "ori/pdf-viewer/meta.json"
		},
		{
			"content": "<script lang=\"ts\" module>\r\n  export interface PdfRendererProps {\r\n    class?: string;\r\n  }\r\n</script>\r\n\r\n<script lang=\"ts\">\r\n  import { getContext, onMount, tick } from 'svelte';\r\n  import { cn } from '$LIB$/utils';\r\n  import type { PdfViewerContext } from './pdf-viewer-root.svelte';\r\n\r\n  let {\r\n    class: className = ''\r\n  }: PdfRendererProps = $props();\r\n\r\n  const context = getContext<PdfViewerContext>('pdfViewerContext');\r\n\r\n  let container: HTMLDivElement | null = $state(null);\r\n  let renderedPages = $state<Map<number, HTMLCanvasElement>>(new Map());\r\n  let renderingPages = $state<Set<number>>(new Set());\r\n  let renderVersion = $state(0); // Used to cancel stale renders\r\n\r\n  // Derived values from context\r\n  let currentPage = $derived(context.currentPage);\r\n  let zoom = $derived(context.zoom);\r\n  let pdf = $derived(context.pdf);\r\n  let totalPages = $derived(context.totalPages);\r\n  let viewMode = $derived(context.viewMode);\r\n\r\n  // Track previous zoom to detect changes\r\n  let prevZoom = $state(1);\r\n\r\n  async function renderSinglePage(pageNum: number, targetZoom: number, version: number): Promise<HTMLCanvasElement | undefined> {\r\n    if (!pdf) return undefined;\r\n    \r\n    // Check if this render is still relevant\r\n    if (version !== renderVersion) return undefined;\r\n\r\n    try {\r\n      const page = await pdf.getPage(pageNum);\r\n      \r\n      // Check again after async operation\r\n      if (version !== renderVersion) return undefined;\r\n      \r\n      const dpr = window.devicePixelRatio || 1;\r\n      const viewport = page.getViewport({ scale: targetZoom * dpr });\r\n\r\n      // Create a new canvas for double-buffering (render off-screen first)\r\n      const canvas = document.createElement('canvas');\r\n      canvas.className = 'pdf-page-canvas block shadow-lg rounded-sm';\r\n      canvas.dataset.page = String(pageNum);\r\n      \r\n      const ctx = canvas.getContext('2d');\r\n      if (!ctx) return undefined;\r\n\r\n      // Set canvas dimensions\r\n      canvas.width = viewport.width;\r\n      canvas.height = viewport.height;\r\n      canvas.style.width = `${viewport.width / dpr}px`;\r\n      canvas.style.height = `${viewport.height / dpr}px`;\r\n\r\n      // Enable high quality rendering\r\n      ctx.imageSmoothingEnabled = true;\r\n      ctx.imageSmoothingQuality = 'high';\r\n\r\n      // Render the page\r\n      await page.render({\r\n        canvasContext: ctx,\r\n        viewport,\r\n        canvas\r\n      }).promise;\r\n\r\n      // Final version check after render\r\n      if (version !== renderVersion) return undefined;\r\n\r\n      return canvas;\r\n    } catch (err: any) {\r\n      if (err?.name !== 'RenderingCancelled') {\r\n        console.error(`Error rendering PDF page ${pageNum}:`, err);\r\n      }\r\n      return undefined;\r\n    }\r\n  }\r\n\r\n  async function renderCurrentPage() {\r\n    if (!pdf || !container) return;\r\n    \r\n    const version = ++renderVersion;\r\n    const pageNum = currentPage;\r\n    const targetZoom = zoom;\r\n\r\n    // Check if we already have this page rendered at the current zoom\r\n    const existingCanvas = renderedPages.get(pageNum);\r\n    if (existingCanvas && prevZoom === targetZoom) {\r\n      // Just ensure it's displayed\r\n      updateSinglePageDisplay(existingCanvas);\r\n      return;\r\n    }\r\n\r\n    // If zoom changed, clear cache\r\n    if (prevZoom !== targetZoom) {\r\n      renderedPages = new Map();\r\n      prevZoom = targetZoom;\r\n    }\r\n\r\n    // Check if already rendering this page\r\n    if (renderingPages.has(pageNum)) return;\r\n\r\n    renderingPages = new Set([...renderingPages, pageNum]);\r\n\r\n    const canvas = await renderSinglePage(pageNum, targetZoom, version);\r\n    \r\n    renderingPages = new Set([...renderingPages].filter(p => p !== pageNum));\r\n\r\n    if (canvas && version === renderVersion) {\r\n      renderedPages = new Map([...renderedPages, [pageNum, canvas]]);\r\n      updateSinglePageDisplay(canvas);\r\n    }\r\n  }\r\n\r\n  function updateSinglePageDisplay(canvas: HTMLCanvasElement) {\r\n    if (!container) return;\r\n    \r\n    // Only update if needed - this prevents flickering\r\n    const existingCanvas = container.querySelector('canvas');\r\n    if (existingCanvas && \r\n        existingCanvas.dataset.page === canvas.dataset.page && \r\n        existingCanvas.width === canvas.width) {\r\n      return; // Already showing this canvas\r\n    }\r\n\r\n    // Smooth transition: add new canvas, then remove old ones\r\n    container.appendChild(canvas);\r\n    \r\n    // Remove old canvases after a tiny delay to prevent flash\r\n    requestAnimationFrame(() => {\r\n      const canvases = container?.querySelectorAll('canvas');\r\n      canvases?.forEach(c => {\r\n        if (c !== canvas) {\r\n          c.remove();\r\n        }\r\n      });\r\n    });\r\n  }\r\n\r\n  async function renderAllPages() {\r\n    if (!pdf || !container || totalPages === 0) return;\r\n    \r\n    const version = ++renderVersion;\r\n    const targetZoom = zoom;\r\n\r\n    // If zoom changed, clear cache\r\n    if (prevZoom !== targetZoom) {\r\n      renderedPages = new Map();\r\n      prevZoom = targetZoom;\r\n    }\r\n\r\n    // Clear container for scroll view\r\n    container.innerHTML = '';\r\n\r\n    // Render all pages\r\n    for (let i = 1; i <= totalPages; i++) {\r\n      if (version !== renderVersion) break;\r\n\r\n      // Check cache first\r\n      let canvas: HTMLCanvasElement | undefined = renderedPages.get(i);\r\n      \r\n      if (!canvas) {\r\n        renderingPages = new Set([...renderingPages, i]);\r\n        const newCanvas = await renderSinglePage(i, targetZoom, version);\r\n        renderingPages = new Set([...renderingPages].filter(p => p !== i));\r\n        \r\n        if (newCanvas) {\r\n          canvas = newCanvas;\r\n          renderedPages = new Map([...renderedPages, [i, canvas]]);\r\n        }\r\n      }\r\n\r\n      if (canvas && version === renderVersion && container) {\r\n        // Create page wrapper\r\n        const wrapper = document.createElement('div');\r\n        wrapper.className = 'pdf-page-wrapper mb-4 last:mb-0';\r\n        wrapper.dataset.page = String(i);\r\n        \r\n        // Clone canvas for display\r\n        const displayCanvas = canvas.cloneNode(true) as HTMLCanvasElement;\r\n        const ctx = displayCanvas.getContext('2d');\r\n        ctx?.drawImage(canvas, 0, 0);\r\n        \r\n        wrapper.appendChild(displayCanvas);\r\n        container.appendChild(wrapper);\r\n      }\r\n    }\r\n  }\r\n\r\n  // Handle scroll to update current page in scroll mode\r\n  function handleScroll() {\r\n    if (viewMode !== 'scroll' || !container) return;\r\n    \r\n    const wrappers = container.querySelectorAll('.pdf-page-wrapper');\r\n    const containerRect = container.getBoundingClientRect();\r\n    const containerMiddle = containerRect.top + containerRect.height / 2;\r\n\r\n    let closestPage = 1;\r\n    let closestDistance = Infinity;\r\n\r\n    wrappers.forEach((wrapper) => {\r\n      const rect = wrapper.getBoundingClientRect();\r\n      const pageMiddle = rect.top + rect.height / 2;\r\n      const distance = Math.abs(pageMiddle - containerMiddle);\r\n      \r\n      if (distance < closestDistance) {\r\n        closestDistance = distance;\r\n        closestPage = parseInt(wrapper.getAttribute('data-page') || '1', 10);\r\n      }\r\n    });\r\n\r\n    if (closestPage !== context.currentPage) {\r\n      context.setPage(closestPage);\r\n    }\r\n  }\r\n\r\n  // Re-render when relevant state changes\r\n  $effect(() => {\r\n    if (pdf && totalPages > 0) {\r\n      if (viewMode === 'single') {\r\n        // Single page mode: render current page\r\n        if (currentPage && zoom) {\r\n          renderCurrentPage();\r\n        }\r\n      } else {\r\n        // Scroll mode: render all pages\r\n        if (zoom) {\r\n          renderAllPages();\r\n        }\r\n      }\r\n    }\r\n  });\r\n\r\n  onMount(() => {\r\n    return () => {\r\n      // Cleanup: increment version to cancel pending renders\r\n      renderVersion++;\r\n    };\r\n  });\r\n</script>\r\n\r\n<div\r\n\tbind:this={container}\r\n\tclass={cn(\r\n\t\t'pdf-renderer relative overflow-auto',\r\n\t\tviewMode === 'single' ? 'flex items-center justify-center' : 'flex flex-col items-center',\r\n\t\tclassName\r\n\t)}\r\n\tonscroll={viewMode === 'scroll' ? handleScroll : undefined}\r\n>\r\n\t{#if renderingPages.size > 0 && renderedPages.size === 0}\r\n\t\t<div class=\"flex items-center justify-center p-8\">\r\n\t\t\t<div\r\n\t\t\t\tclass=\"h-6 w-6 animate-spin rounded-full\"\r\n\t\t\t\tstyle=\"border: 2px solid hsl(var(--primary)); border-top-color: transparent;\"\r\n\t\t\t></div>\r\n\t\t</div>\r\n\t{/if}\r\n</div>\r\n\r\n<style>\r\n  .pdf-renderer :global(canvas) {\r\n    max-width: 100%;\r\n    height: auto;\r\n  }\r\n  \r\n  .pdf-renderer :global(.pdf-page-wrapper) {\r\n    display: flex;\r\n    justify-content: center;\r\n  }\r\n</style>\r\n",
			"type": "registry:file",
			"target": "ori/pdf-viewer/pdf-renderer.svelte"
		},
		{
			"content": "<script lang=\"ts\" module>\r\n  import type { Snippet } from 'svelte';\r\n\r\n  export interface PdfToolbarProps {\r\n    class?: string;\r\n    showPageControls?: boolean;\r\n    showZoomControls?: boolean;\r\n    showViewModeToggle?: boolean;\r\n  }\r\n</script>\r\n\r\n<script lang=\"ts\">\r\n  import { getContext } from 'svelte';\r\n  import { cn } from '$LIB$/utils';\r\n  import type { PdfViewerContext } from './pdf-viewer-root.svelte';\r\n  import {\r\n    IconChevronLeft,\r\n    IconChevronRight,\r\n    IconMinus,\r\n    IconPlus,\r\n    IconZoomReset,\r\n    IconLayoutList,\r\n    IconFile\r\n  } from '@tabler/icons-svelte';\r\n\r\n  let {\r\n    class: className = '',\r\n    showPageControls = true,\r\n    showZoomControls = true,\r\n    showViewModeToggle = true\r\n  }: PdfToolbarProps = $props();\r\n\r\n  const context = getContext<PdfViewerContext>('pdfViewerContext');\r\n\r\n  // Derived values from context\r\n  let currentPage = $derived(context.currentPage);\r\n  let totalPages = $derived(context.totalPages);\r\n  let zoom = $derived(context.zoom);\r\n  let viewMode = $derived(context.viewMode);\r\n\r\n  let pageInputValue = $state('');\r\n  \r\n  // Sync input with current page\r\n  $effect(() => {\r\n    pageInputValue = String(currentPage);\r\n  });\r\n\r\n  function handlePageInput(e: Event) {\r\n    const input = e.target as HTMLInputElement;\r\n    const value = parseInt(input.value, 10);\r\n    if (!isNaN(value) && value >= 1 && value <= totalPages) {\r\n      context.setPage(value);\r\n    }\r\n  }\r\n\r\n  function handlePageKeydown(e: KeyboardEvent) {\r\n    if (e.key === 'Enter') {\r\n      handlePageInput(e);\r\n    }\r\n  }\r\n\r\n  function handleZoomSelect(e: Event) {\r\n    const select = e.target as HTMLSelectElement;\r\n    const value = parseFloat(select.value);\r\n    if (!isNaN(value)) {\r\n      context.setZoom(value);\r\n    }\r\n  }\r\n\r\n  const zoomPresets = [0.5, 0.75, 1, 1.25, 1.5, 2, 3];\r\n</script>\r\n\r\n<div\r\n\tclass={cn(\r\n\t\t'pdf-toolbar flex flex-wrap items-center justify-center gap-2 rounded-lg bg-muted/50 backdrop-blur-sm border border-border p-2',\r\n\t\tclassName\r\n\t)}\r\n>\r\n\t{#if showViewModeToggle}\r\n\t\t<div class=\"flex items-center gap-1\">\r\n\t\t\t<button\r\n\t\t\t\tonclick={() => context.setViewMode('single')}\r\n\t\t\t\tclass={cn(\r\n\t\t\t\t\t'inline-flex h-8 w-8 items-center justify-center rounded-md border border-border transition-colors',\r\n\t\t\t\t\tviewMode === 'single'\r\n\t\t\t\t\t\t? 'bg-primary text-primary-foreground'\r\n\t\t\t\t\t\t: 'bg-background text-foreground hover:bg-accent'\r\n\t\t\t\t)}\r\n\t\t\t\taria-label=\"Single page view\"\r\n\t\t\t\ttitle=\"Single page view\"\r\n\t\t\t>\r\n\t\t\t\t<IconFile size={18} />\r\n\t\t\t</button>\r\n\t\t\t<button\r\n\t\t\t\tonclick={() => context.setViewMode('scroll')}\r\n\t\t\t\tclass={cn(\r\n\t\t\t\t\t'inline-flex h-8 w-8 items-center justify-center rounded-md border border-border transition-colors',\r\n\t\t\t\t\tviewMode === 'scroll'\r\n\t\t\t\t\t\t? 'bg-primary text-primary-foreground'\r\n\t\t\t\t\t\t: 'bg-background text-foreground hover:bg-accent'\r\n\t\t\t\t)}\r\n\t\t\t\taria-label=\"Scroll view\"\r\n\t\t\t\ttitle=\"Scroll view (all pages)\"\r\n\t\t\t>\r\n\t\t\t\t<IconLayoutList size={18} />\r\n\t\t\t</button>\r\n\t\t</div>\r\n\r\n\t\t<div class=\"h-6 w-px bg-border\"></div>\r\n\t{/if}\r\n\r\n\t{#if showPageControls}\r\n\t\t<div class=\"flex items-center gap-1.5\">\r\n\t\t\t<button\r\n\t\t\t\tonclick={() => context.prevPage()}\r\n\t\t\t\tdisabled={currentPage <= 1}\r\n\t\t\t\tclass=\"inline-flex h-8 w-8 items-center justify-center rounded-md bg-background border border-border text-foreground transition-colors hover:bg-accent disabled:opacity-50 disabled:cursor-not-allowed\"\r\n\t\t\t\taria-label=\"Previous page\"\r\n\t\t\t>\r\n\t\t\t\t<IconChevronLeft size={18} />\r\n\t\t\t</button>\r\n\r\n\t\t\t<div class=\"flex items-center gap-1.5 px-2\">\r\n\t\t\t\t<input\r\n\t\t\t\t\ttype=\"text\"\r\n\t\t\t\t\tinputmode=\"numeric\"\r\n\t\t\t\t\tvalue={pageInputValue}\r\n\t\t\t\t\toninput={(e) => (pageInputValue = (e.target as HTMLInputElement).value)}\r\n\t\t\t\t\tonblur={handlePageInput}\r\n\t\t\t\t\tonkeydown={handlePageKeydown}\r\n\t\t\t\t\tclass=\"h-8 w-12 rounded-md border border-border bg-background px-2 text-center text-sm text-foreground focus:outline-none focus:border-primary\"\r\n\t\t\t\t\taria-label=\"Current page\"\r\n\t\t\t\t/>\r\n\t\t\t\t<span class=\"text-sm text-muted-foreground\">of {totalPages}</span>\r\n\t\t\t</div>\r\n\r\n\t\t\t<button\r\n\t\t\t\tonclick={() => context.nextPage()}\r\n\t\t\t\tdisabled={currentPage >= totalPages}\r\n\t\t\t\tclass=\"inline-flex h-8 w-8 items-center justify-center rounded-md bg-background border border-border text-foreground transition-colors hover:bg-accent disabled:opacity-50 disabled:cursor-not-allowed\"\r\n\t\t\t\taria-label=\"Next page\"\r\n\t\t\t>\r\n\t\t\t\t<IconChevronRight size={18} />\r\n\t\t\t</button>\r\n\t\t</div>\r\n\t{/if}\r\n\r\n\t{#if showPageControls && showZoomControls}\r\n\t\t<div class=\"h-6 w-px bg-border\"></div>\r\n\t{/if}\r\n\r\n\t{#if showZoomControls}\r\n\t\t<div class=\"flex items-center gap-1.5\">\r\n\t\t\t<button\r\n\t\t\t\tonclick={() => context.zoomOut()}\r\n\t\t\t\tdisabled={zoom <= 0.25}\r\n\t\t\t\tclass=\"inline-flex h-8 w-8 items-center justify-center rounded-md bg-background border border-border text-foreground transition-colors hover:bg-accent disabled:opacity-50 disabled:cursor-not-allowed\"\r\n\t\t\t\taria-label=\"Zoom out\"\r\n\t\t\t>\r\n\t\t\t\t<IconMinus size={18} />\r\n\t\t\t</button>\r\n\r\n\t\t\t<select\r\n\t\t\t\tvalue={zoom}\r\n\t\t\t\tonchange={handleZoomSelect}\r\n\t\t\t\tclass=\"h-8 rounded-md border border-border bg-background px-2 text-sm text-foreground focus:outline-none focus:border-primary cursor-pointer\"\r\n\t\t\t\taria-label=\"Zoom level\"\r\n\t\t\t>\r\n\t\t\t\t{#each zoomPresets as preset}\r\n\t\t\t\t\t<option value={preset} selected={Math.abs(zoom - preset) < 0.01}>\r\n\t\t\t\t\t\t{Math.round(preset * 100)}%\r\n\t\t\t\t\t</option>\r\n\t\t\t\t{/each}\r\n\t\t\t\t{#if !zoomPresets.some((p) => Math.abs(zoom - p) < 0.01)}\r\n\t\t\t\t\t<option value={zoom} selected>{Math.round(zoom * 100)}%</option>\r\n\t\t\t\t{/if}\r\n\t\t\t</select>\r\n\r\n\t\t\t<button\r\n\t\t\t\tonclick={() => context.zoomIn()}\r\n\t\t\t\tdisabled={zoom >= 5}\r\n\t\t\t\tclass=\"inline-flex h-8 w-8 items-center justify-center rounded-md bg-background border border-border text-foreground transition-colors hover:bg-accent disabled:opacity-50 disabled:cursor-not-allowed\"\r\n\t\t\t\taria-label=\"Zoom in\"\r\n\t\t\t>\r\n\t\t\t\t<IconPlus size={18} />\r\n\t\t\t</button>\r\n\r\n\t\t\t<button\r\n\t\t\t\tonclick={() => context.resetZoom()}\r\n\t\t\t\tclass=\"inline-flex h-8 w-8 items-center justify-center rounded-md bg-background border border-border text-foreground transition-colors hover:bg-accent\"\r\n\t\t\t\taria-label=\"Reset zoom\"\r\n\t\t\t>\r\n\t\t\t\t<IconZoomReset size={18} />\r\n\t\t\t</button>\r\n\t\t</div>\r\n\t{/if}\r\n</div>\r\n",
			"type": "registry:file",
			"target": "ori/pdf-viewer/pdf-toolbar.svelte"
		},
		{
			"content": "<script lang=\"ts\" module>\r\n  import { cn } from '$LIB$/utils';\r\n  import type { PDFDocumentProxy } from 'pdfjs-dist';\r\n  import type { Snippet } from 'svelte';\r\n\r\n  export type ViewMode = 'single' | 'scroll';\r\n\r\n  export interface PdfViewerContext {\r\n    currentPage: number;\r\n    totalPages: number;\r\n    zoom: number;\r\n    viewMode: ViewMode;\r\n    pdf: PDFDocumentProxy | null;\r\n    loading: boolean;\r\n    error: string | null;\r\n    setPage: (page: number) => void;\r\n    setZoom: (zoom: number) => void;\r\n    setViewMode: (mode: ViewMode) => void;\r\n    nextPage: () => void;\r\n    prevPage: () => void;\r\n    zoomIn: () => void;\r\n    zoomOut: () => void;\r\n    resetZoom: () => void;\r\n    toggleViewMode: () => void;\r\n  }\r\n\r\n  export interface PdfViewerRootProps {\r\n    src: string;\r\n    children?: Snippet;\r\n    class?: string;\r\n    initialPage?: number;\r\n    initialZoom?: number;\r\n    initialViewMode?: ViewMode;\r\n  }\r\n</script>\r\n\r\n<script lang=\"ts\">\r\n  import { onMount, setContext } from 'svelte';\r\n  import * as pdfjsLib from 'pdfjs-dist';\r\n\r\n  let {\r\n    src,\r\n    children,\r\n    class: className = '',\r\n    initialPage = 1,\r\n    initialZoom = 1,\r\n    initialViewMode = 'single'\r\n  }: PdfViewerRootProps = $props();\r\n\r\n  // PDF state using Svelte 5 runes\r\n  let currentPage = $state(1);\r\n  let totalPages = $state(0);\r\n  let zoom = $state(1);\r\n  let viewMode = $state<ViewMode>('single');\r\n  let pdf = $state<PDFDocumentProxy | null>(null);\r\n  let loading = $state(true);\r\n  let error = $state<string | null>(null);\r\n\r\n  // Navigation functions\r\n  function setPage(page: number) {\r\n    if (page >= 1 && page <= totalPages) {\r\n      currentPage = page;\r\n    }\r\n  }\r\n\r\n  function nextPage() {\r\n    if (currentPage < totalPages) {\r\n      currentPage++;\r\n    }\r\n  }\r\n\r\n  function prevPage() {\r\n    if (currentPage > 1) {\r\n      currentPage--;\r\n    }\r\n  }\r\n\r\n  function setZoom(z: number) {\r\n    zoom = Math.max(0.25, Math.min(5, z));\r\n  }\r\n\r\n  function zoomIn() {\r\n    setZoom(zoom + 0.25);\r\n  }\r\n\r\n  function zoomOut() {\r\n    setZoom(zoom - 0.25);\r\n  }\r\n\r\n  function resetZoom() {\r\n    zoom = 1;\r\n  }\r\n\r\n  function setViewMode(mode: ViewMode) {\r\n    viewMode = mode;\r\n  }\r\n\r\n  function toggleViewMode() {\r\n    viewMode = viewMode === 'single' ? 'scroll' : 'single';\r\n  }\r\n\r\n  // Create context with getters that return current values\r\n  const context: PdfViewerContext = {\r\n    get currentPage() { return currentPage; },\r\n    get totalPages() { return totalPages; },\r\n    get zoom() { return zoom; },\r\n    get viewMode() { return viewMode; },\r\n    get pdf() { return pdf; },\r\n    get loading() { return loading; },\r\n    get error() { return error; },\r\n    setPage,\r\n    setZoom,\r\n    setViewMode,\r\n    nextPage,\r\n    prevPage,\r\n    zoomIn,\r\n    zoomOut,\r\n    resetZoom,\r\n    toggleViewMode\r\n  };\r\n\r\n  setContext('pdfViewerContext', context);\r\n\r\n  onMount(async () => {\r\n    try {\r\n      loading = true;\r\n      error = null;\r\n\r\n      // Set up worker for pdfjs-dist v5\r\n      pdfjsLib.GlobalWorkerOptions.workerSrc = new URL(\r\n        'pdfjs-dist/build/pdf.worker.min.mjs',\r\n        import.meta.url\r\n      ).toString();\r\n\r\n      // Load the PDF document\r\n      const loadingTask = pdfjsLib.getDocument(src);\r\n      const doc = await loadingTask.promise;\r\n      \r\n      pdf = doc;\r\n      totalPages = doc.numPages;\r\n      currentPage = Math.min(initialPage, doc.numPages);\r\n      zoom = initialZoom;\r\n      viewMode = initialViewMode;\r\n      loading = false;\r\n    } catch (err) {\r\n      console.error('Failed to load PDF:', err);\r\n      error = err instanceof Error ? err.message : 'Failed to load PDF';\r\n      loading = false;\r\n    }\r\n  });\r\n</script>\r\n\r\n<div class={cn('pdf-viewer-root relative', className)}>\r\n\t{#if loading}\r\n\t\t<div class=\"flex items-center justify-center p-8\">\r\n\t\t\t<div class=\"flex flex-col items-center gap-3\">\r\n\t\t\t\t<div\r\n\t\t\t\t\tclass=\"h-8 w-8 animate-spin rounded-full\"\r\n\t\t\t\t\tstyle=\"border: 4px solid hsl(var(--primary)); border-top-color: transparent;\"\r\n\t\t\t\t></div>\r\n\t\t\t\t<span class=\"text-muted-foreground text-sm\">Loading PDF...</span>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t{:else if error}\r\n\t\t<div class=\"flex items-center justify-center p-8\">\r\n\t\t\t<div class=\"text-destructive text-center\">\r\n\t\t\t\t<p class=\"font-medium\">Error loading PDF</p>\r\n\t\t\t\t<p class=\"text-sm opacity-80\">{error}</p>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t{:else}\r\n\t\t{@render children?.()}\r\n\t{/if}\r\n</div>\r\n",
			"type": "registry:file",
			"target": "ori/pdf-viewer/pdf-viewer-root.svelte"
		}
	]
}